const attachEditFormativeAssessmentButton=function(e){e.setAttribute("kami-processed",!0);const t=document.createElement("a");t.classList.add("kami-edit-material-link"),t.innerHTML="Edit Material",t.href="javascript:void(0)",t.addEventListener("click",handleEditMaterialLinkClick),e.prepend(t)},handleEditMaterialLinkClick=function(){wrapEditMaterialWindowOpen();window.location.href;var e=document.querySelector(".ndfHFb-c4YZDc-z5C9Gb-LgbsSe"),t=document.createEvent("MouseEvents");t.initEvent("mousedown",!0,!0),e.dispatchEvent(t),setTimeout((function(){var e=document.querySelector(".ndfHFb-c4YZDc-j7LFlb-Bz112c.ndfHFb-c4YZDc-GSQQnc-LgbsSe").parentElement,t=e.getBoundingClientRect(),n=new MouseEvent("mouseup",{view:window,bubbles:!0,cancelable:!0,clientX:t.left+5,clientY:t.top+5,x:t.left+5,y:t.top+5});e.dispatchEvent(n)}),10)};var wrapEditMaterialWindowOpenScript=function(){/\{\s*\[native code\]\s*\}/.test(""+window.open)&&(window.originalOpen=window.open),window.open=function(){window.open=window.originalOpen;var e=new URL(arguments[0]),t=/^https:\/\/drive\.google\.com\/(open|file\/d\/|document\/d\/)/.test(e.href);if(t){google_file_id=e.searchParams.get("id")||e.pathname.split("/")[3];var n=window.location.href.split("/");kamiURL="https://web.kamihq.com"+"/web/viewer.html?open_formative_assessment=true&alternative_course_id="+n[4]+"&alternate_coursework_id="+n[6]+"&google_file_id="+google_file_id+"&authuser="+e.searchParams.get("authuser"),window.open(kamiURL,"_blank")}else window.open.apply(this,arguments)};var e=document.currentScript;e&&null!==e.parentNode&&e.parentNode.removeChild(e)};const wrapEditMaterialWindowOpen=function(){var e=document.head||document.documentElement;if(null===e)return!1;var t=document.createElement("script");t.textContent="("+wrapEditMaterialWindowOpenScript.toString()+")();";try{e.appendChild(t)}catch(e){}},showEditFormativeAssessmentButton=e=>{if(e)return 0!=="student".localeCompare(e,void 0,{sensitivity:"accent"});const t=document.querySelectorAll("div.gb_be > div > div.gb_rb"),n=t&&1===t.length&&t[0].textContent;if(n){return!Array.from(document.querySelectorAll("a.vwNuXe.JkIgWb.QRiHXd.MymH0d.maXJsd")||[]).some((e=>(e.getAttribute("aria-label")||"").startsWith(`Attachment: PDF: ${n} -`)))}return!0},userKey="notable.user";chrome.storage.sync.get([userKey],(function(e){const t=e[userKey]&&e[userKey].user_profile&&e[userKey].user_profile.user_segmentation;observers.courseWork=new MutationObserver((function(e){for(mutation of e){if(!mutation.addedNodes)return;const e=document.querySelector(".kami-drive-viewer-toolstrip-mid-panel");if(!e||e.getAttribute("kami-processed"))return;if(!showEditFormativeAssessmentButton(t))return;attachEditFormativeAssessmentButton(e)}})),observers.courseWork.observe(document.body,{childList:!0,subtree:!0})}));